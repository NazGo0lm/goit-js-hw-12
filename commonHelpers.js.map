{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst refs = {\nimageSearchForm: document.querySelector('.search-form'),\nimageSearchInput: document.querySelector('.search-input'),\nsubmitButton: document.querySelector('.search-btn'),\nimageList: document.querySelector('.images-list'),\n}\n\n\n\n\n\nexport function renderImages(images) {\n    if (!images || !images.hits) {\n        return '';\n    }\n    return images.hits.map((image) => {\n        return `<li class=\"images-list-item\">\n            <a class=\"img-link\" href=${image.largeImageURL} onclick=\"event.preventDefault()\"><img class=\"img\" src=${image.webformatURL} alt=${image.tags}></img></a>\n            <ul class=\"img-dscr\">\n                <li class=\"img-data\">\n                    <p class=\"img-data-title\">Likes</p>\n                    <p class=\"img-data-numbers\">${image.likes}</p>\n                </li>\n                <li class=\"img-data\">\n                    <p class=\"img-data-title\">Views</p>\n                    <p class=\"img-data-numbers\">${image.views}</p>\n                </li>\n                <li class=\"img-data\">\n                    <p class=\"img-data-title\">Comments</p>\n                    <p class=\"img-data-numbers\">${image.comments}</p>\n                </li>\n                <li class=\"img-data\">\n                    <p class=\"img-data-title\">Downloads</p>\n                    <p class=\"img-data-numbers\">${image.downloads}</p>\n                </li>\n            </ul>\n        </li>`;\n    }).join('');\n}\n    //refs.imageList.innerHTML = markup; \n\n    \n","import axios from 'axios';\n\nexport async function getImages(query, currentPage) {\n    const BASE_URL = 'https://pixabay.com';\n    const END_POINT = '/api/';\n\n    const params = new URLSearchParams({\n        key: '44477511-7934322deb574a4a64d25451d',\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page: currentPage,\n        per_page: 15,\n\n    })\n    \n    const url = `${BASE_URL}${END_POINT}?${params}`;\n    //console.log(url);\n    \n    const options = {\n        headers: {\n            // 'Access-Control-Allow-Origin': '*', \n            \"Content-Type\": \"application/json\",\n\n            /* 'X-RateLimit-Limit': '100',\n            'X-RateLimit-Remaining': '99',\n            'X-RateLimit-Reset': '0.6', */\n    },\n}\n    \n    const res = await axios.get(url, { options });\n    return res.data;\n    \n} ","import axios from 'axios';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport { renderImages } from \"./js/render-functions\";\nimport { getImages } from \"./js/pixabay-api\";\n\nconst refs = {\n    imageSearchForm: document.querySelector('.search-form'),\n    imageSearchInput: document.querySelector('.search-input'),\n    submitButton: document.querySelector('.search-btn'),\n    imageList: document.querySelector('.images-list'),\n    loader: document.querySelector('.loader'),\n    loading: document.querySelector('.loading'),\n    loadBtn: document.querySelector('.load-more-btn'),\n}\n\nrefs.loader.style.display = 'none';\nlet currentPage = 1;\nlet maxPage = 1;\nconst perPage = 15;\n\nlet queryGlobal;\n\nrefs.imageSearchForm.addEventListener('submit', async e => {\n    e.preventDefault();\n    let query = e.target.elements.userData.value.trim();\n    queryGlobal = query;\n    if (query === '') {\n        refs.imageList.innerHTML = '';\n        refs.loader.style.display = 'none';\n        refs.loadBtn.style.display = 'none';\n        return iziToast.error({\n            message: 'Sorry, there are no images matching your search query. Please try again!',\n            position: 'bottomRight',\n            transitionIn: 'bounceInDown',\n            transitionOut: 'fadeOutDown',\n        });\n    }\n    refs.loader.style.display = 'block';\n    currentPage = 1;\n\n    try {\n        \n        const data = await getImages(query, currentPage);\n        //console.log(data.total)\n        maxPage = Math.ceil(data.total / perPage);\n        //console.log(maxPage)\n\n\n        \n\n        if (maxPage === 0) {\n            refs.imageList.innerHTML = '';\n            refs.loader.style.display = 'none';\n            refs.loadBtn.style.display = 'none';\n            return iziToast.error({\n            message: 'Sorry, there are no images matching your search query. Please try again!',\n            position: 'bottomRight',\n            transitionIn: 'bounceInDown',\n                transitionOut: 'fadeOutDown',\n            \n        });\n        }\n        \n        const markup = renderImages(data);\n         refs.imageList.innerHTML = markup;\n\n        const lightbox = new SimpleLightbox('.images-list-item a', {\n            captions: true,\n            captionSelector: 'img',\n            captionType: 'attr',\n            captionsData: 'alt',\n            captionPosition: 'bottom',\n            captionDelay: 250,\n            animationSpeed: 300,\n            widthRatio: 1,\n            heightRatio: 0.95,\n            disableRightClick: true,\n        });\n        lightbox.refresh();\n    } catch (error) {\n        // Обробка помилок, якщо потрібно\n    }\n    e.target.reset();\n    refs.loader.style.display = 'none';\n    //noLoadBtn()\n    \n    refs.loadBtn.style.display = 'block';\n    \n            noLoadBtn()\n            //console.log(currentPage)\n            //console.log(maxPage)\n        \n\n\n\n\n\n\n\n    \n})\n\nrefs.loadBtn.addEventListener('click', async (e) => {\n    e.preventDefault();\n    //let query = e.target.elements.userData.value.trim();\n    refs.loading.style.display = 'block';\n    refs.loadBtn.style.display = 'none';\n    currentPage++;\n\n    try {\n        const data = await getImages(queryGlobal, currentPage); \n        //console.log(data);\n        \n        const markup = renderImages(data);\n        refs.imageList.insertAdjacentHTML('beforeend', markup);\n\n        const lightbox = new SimpleLightbox('.images-list-item a', {\n            captions: true,\n            captionSelector: 'img',\n            captionType: 'attr',\n            captionsData: 'alt',\n            captionPosition: 'bottom',\n            captionDelay: 250,\n            animationSpeed: 300,\n            widthRatio: 1,\n            heightRatio: 0.95,\n            disableRightClick: true,\n        });\n        lightbox.refresh();\n        skipOldElement()\n    } catch (error) {\n        console.log('Error: ', error);\n    }\n\n    refs.loading.style.display = 'none';\n    //refs.loadBtn.style.display = 'block';\n\n\n  \n            noLoadBtn()\n            //console.log(currentPage)\n            //console.log(maxPage)\n        \n     \n});\n\n\n\nfunction noLoadBtn() {\n  if (currentPage >= maxPage) {\n    refs.loadBtn.style.display = 'none';\n\n    if (currentPage === maxPage) {\n      iziToast.info({\n        /* title: 'The End!', */\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    } \n  } \n  else {\n    refs.loadBtn.style.display = 'block';\n  }\n}\n\n\nfunction skipOldElement() {\n  const liElem = refs.imageList.children[0];\n  const height = liElem.getBoundingClientRect().height;\n\n  scrollBy({\n    top: height * 3,\n    behavior: 'smooth',\n  });\n}\n\n"],"names":["renderImages","images","image","getImages","query","currentPage","BASE_URL","END_POINT","params","url","options","axios","refs","maxPage","perPage","queryGlobal","e","iziToast","data","markup","SimpleLightbox","noLoadBtn","skipOldElement","error","height"],"mappings":"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"}